
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Mathematical Functions &#8212; Velox  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/nature.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Bitwise Functions" href="bitwise.html" />
    <link rel="prev" title="Spark Functions" href="../../spark_functions.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="bitwise.html" title="Bitwise Functions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../../spark_functions.html" title="Spark Functions"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Velox  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../spark_functions.html" accesskey="U">Spark Functions</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Mathematical Functions</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="mathematical-functions">
<h1>Mathematical Functions<a class="headerlink" href="#mathematical-functions" title="Permalink to this heading">¶</a></h1>
<dl class="spark function">
<dt class="sig sig-object spark" id="abs">
<span class="sig-name descname"><span class="pre">abs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">[same</span> <span class="pre">as</span> <span class="pre">x]</span></span></span><a class="headerlink" href="#abs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the absolute value of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="acos">
<span class="sig-name descname"><span class="pre">acos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">double</span></span></span><a class="headerlink" href="#acos" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the inverse cosine (a.k.a. arc cosine) of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="acosh">
<span class="sig-name descname"><span class="pre">acosh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">double</span></span></span><a class="headerlink" href="#acosh" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns inverse hyperbolic cosine of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="asinh">
<span class="sig-name descname"><span class="pre">asinh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">double</span></span></span><a class="headerlink" href="#asinh" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns inverse hyperbolic sine of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="atanh">
<span class="sig-name descname"><span class="pre">atanh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">double</span></span></span><a class="headerlink" href="#atanh" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns inverse hyperbolic tangent of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">[same</span> <span class="pre">as</span> <span class="pre">x]</span></span></span><a class="headerlink" href="#add" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the result of adding x to y. The types of x and y must be the same.
For integral types, overflow results in an error. Corresponds to sparks’s operator <code class="docutils literal notranslate"><span class="pre">+</span></code>.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="id0">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">decimal</span></span></span><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the result of adding <code class="docutils literal notranslate"><span class="pre">x</span></code> to <code class="docutils literal notranslate"><span class="pre">y</span></code>. The argument types should be DECIMAL, and can have different precisions and scales.
Fast path is implemented for cases that should not overflow. For the others, the whole parts and fractional parts of input decimals are added separately and combined finally.
The result type is calculated with the max precision of input precisions, the max scale of input scales, and one extra digit for possible carrier.
Overflow results in null output. Corresponds to Spark’s operator <code class="docutils literal notranslate"><span class="pre">+</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">CAST</span><span class="p">(</span><span class="mf">1.1232100</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span> <span class="o">+</span> <span class="n">CAST</span><span class="p">(</span><span class="mi">1</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span> <span class="o">--</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="mf">2.123210</span>
<span class="n">SELECT</span> <span class="n">CAST</span><span class="p">(</span><span class="o">-</span><span class="mf">999999999999999999999999999.999</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="n">CAST</span><span class="p">(</span><span class="o">-</span><span class="mf">999999999999999999999999999.999</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">3</span><span class="p">));</span> <span class="o">--</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span><span class="mf">1999999999999999999999999999.998</span>
<span class="n">SELECT</span> <span class="n">CAST</span><span class="p">(</span><span class="mf">99999999999999999999999999999999.99998</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span> <span class="o">+</span> <span class="n">CAST</span><span class="p">(</span><span class="o">-</span><span class="mf">99999999999999999999999999999999.99999</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">5</span><span class="p">));</span> <span class="o">--</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.000010</span>
<span class="n">SELECT</span> <span class="n">CAST</span><span class="p">(</span><span class="o">-</span><span class="mf">99999999999999999999999999999999990.0</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="n">CAST</span><span class="p">(</span><span class="o">-</span><span class="mf">0.00001</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">7</span><span class="p">));</span> <span class="o">--</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="n">NULL</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="bin">
<span class="sig-name descname"><span class="pre">bin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span><a class="headerlink" href="#bin" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the string representation of the long value <code class="docutils literal notranslate"><span class="pre">x</span></code> represented in binary.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="ceil">
<span class="sig-name descname"><span class="pre">ceil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">[same</span> <span class="pre">as</span> <span class="pre">x]</span></span></span><a class="headerlink" href="#ceil" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">x</span></code> rounded up to the nearest integer.
Supported types are: BIGINT and DOUBLE.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="cosh">
<span class="sig-name descname"><span class="pre">cosh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">double</span></span></span><a class="headerlink" href="#cosh" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the hyperbolic cosine of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="cot">
<span class="sig-name descname"><span class="pre">cot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">double</span></span></span><a class="headerlink" href="#cot" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the cotangent of <a href="#id1"><span class="problematic" id="id2">``</span></a>x``(measured in radians). Supported type is DOUBLE.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="csc">
<span class="sig-name descname"><span class="pre">csc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">double</span></span></span><a class="headerlink" href="#csc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the cosecant of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="divide">
<span class="sig-name descname"><span class="pre">divide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">double</span></span></span><a class="headerlink" href="#divide" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the results of dividing x by y. Performs floating point division.
Supported type is DOUBLE.
Corresponds to Spark’s operator <code class="docutils literal notranslate"><span class="pre">/</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span> <span class="o">--</span> <span class="mf">1.5</span>
<span class="n">SELECT</span> <span class="mi">2</span><span class="n">L</span> <span class="o">/</span> <span class="mi">2</span><span class="n">L</span><span class="p">;</span> <span class="o">--</span> <span class="mf">1.0</span>
<span class="n">SELECT</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">0</span><span class="p">;</span> <span class="o">--</span> <span class="n">NULL</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="id3">
<span class="sig-name descname"><span class="pre">divide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">decimal</span></span></span><a class="headerlink" href="#id3" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the results of dividing x by y.
Supported type is DECIMAL which can be different precision and scale.
Performs floating point division.
The result type depends on the precision and scale of x and y.
Overflow results return null. Corresponds to Spark’s operator <code class="docutils literal notranslate"><span class="pre">/</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">CAST</span><span class="p">(</span><span class="mi">1</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">/</span> <span class="n">CAST</span><span class="p">(</span><span class="mi">2</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">3</span><span class="p">));</span> <span class="o">--</span> <span class="n">decimal</span> <span class="mf">0.500000000000000000000</span>
<span class="n">SELECT</span> <span class="n">CAST</span><span class="p">(</span><span class="mi">1</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">/</span> <span class="n">CAST</span><span class="p">(</span><span class="mi">20</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="o">--</span> <span class="n">decimal</span> <span class="mf">0.0500000000000000000</span>
<span class="n">SELECT</span> <span class="n">CAST</span><span class="p">(</span><span class="mi">1</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">/</span> <span class="n">CAST</span><span class="p">(</span><span class="mi">0</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">));</span> <span class="o">--</span> <span class="n">NULL</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="exp">
<span class="sig-name descname"><span class="pre">exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">double</span></span></span><a class="headerlink" href="#exp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns Euler’s number raised to the power of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="floor">
<span class="sig-name descname"><span class="pre">floor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">[same</span> <span class="pre">as</span> <span class="pre">x]</span></span></span><a class="headerlink" href="#floor" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">x</span></code> rounded down to the nearest integer.
Supported types are: BIGINT and DOUBLE.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="hypot">
<span class="sig-name descname"><span class="pre">hypot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">double</span></span></span><a class="headerlink" href="#hypot" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the square root of <cite>a</cite> squared plus <cite>b</cite> squared.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="log1p">
<span class="sig-name descname"><span class="pre">log1p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">double</span></span></span><a class="headerlink" href="#log1p" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the natural logarithm of the “given value <code class="docutils literal notranslate"><span class="pre">x</span></code> plus one”.
Return NULL if x is less than or equal to -1.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="log2">
<span class="sig-name descname"><span class="pre">log2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">double</span></span></span><a class="headerlink" href="#log2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the logarithm of <code class="docutils literal notranslate"><span class="pre">x</span></code> with base 2. Return null for zero and non-positive input.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="log10">
<span class="sig-name descname"><span class="pre">log10</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">double</span></span></span><a class="headerlink" href="#log10" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the logarithm of <code class="docutils literal notranslate"><span class="pre">x</span></code> with base 10. Return null for zero and non-positive input.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="multiply">
<span class="sig-name descname"><span class="pre">multiply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">[same</span> <span class="pre">as</span> <span class="pre">x]</span></span></span><a class="headerlink" href="#multiply" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the result of multiplying x by y. The types of x and y must be the same.
For integral types, overflow results in an error. Corresponds to Spark’s operator <code class="docutils literal notranslate"><span class="pre">*</span></code>.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="id4">
<span class="sig-name descname"><span class="pre">multiply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="p"><span class="pre">[</span></span><span class="pre">decimal</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#id4" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the result of multiplying x by y. The types of x and y must be decimal which can be different precision and scale.
The result type depends on the precision and scale of x and y.
Overflow results return null. Corresponds to Spark’s operator <code class="docutils literal notranslate"><span class="pre">*</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">CAST</span><span class="p">(</span><span class="mi">1</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="n">CAST</span><span class="p">(</span><span class="mi">2</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">3</span><span class="p">));</span> <span class="o">--</span> <span class="n">decimal</span> <span class="mf">2.000000</span>
<span class="n">SELECT</span> <span class="n">CAST</span><span class="p">(</span><span class="mi">1</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="n">CAST</span><span class="p">(</span><span class="mi">20</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="o">--</span> <span class="n">decimal</span> <span class="mf">20.00000</span>
<span class="n">SELECT</span> <span class="n">CAST</span><span class="p">(</span><span class="mi">1</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="n">CAST</span><span class="p">(</span><span class="mi">0</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">));</span> <span class="o">--</span> <span class="n">decimal</span> <span class="mf">0.000000</span>
<span class="n">SELECT</span> <span class="n">CAST</span><span class="p">(</span><span class="mf">201e-38</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">38</span><span class="p">))</span> <span class="o">*</span> <span class="n">CAST</span><span class="p">(</span><span class="mf">301e-38</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">38</span><span class="p">));</span> <span class="o">--</span> <span class="n">decimal</span> <span class="mf">0.0000000000000000000000000000000000000</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="not">
<span class="sig-name descname"><span class="pre">not</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">boolean</span></span></span><a class="headerlink" href="#not" title="Permalink to this definition">¶</a></dt>
<dd><p>Logical not.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="ow">not</span> <span class="n">true</span><span class="p">;</span> <span class="o">--</span> <span class="n">false</span>
<span class="n">SELECT</span> <span class="ow">not</span> <span class="n">false</span><span class="p">;</span> <span class="o">--</span> <span class="n">true</span>
<span class="n">SELECT</span> <span class="ow">not</span> <span class="n">NULL</span><span class="p">;</span> <span class="o">--</span> <span class="n">NULL</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="pmod">
<span class="sig-name descname"><span class="pre">pmod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">[same</span> <span class="pre">as</span> <span class="pre">n]</span></span></span><a class="headerlink" href="#pmod" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the positive remainder of n divided by m.
Supported types are: TINYINT, SMALLINT, INTEGER, BIGINT, FLOAT and DOUBLE.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="power">
<span class="sig-name descname"><span class="pre">power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">double</span></span></span><a class="headerlink" href="#power" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">x</span></code> raised to the power of <code class="docutils literal notranslate"><span class="pre">p</span></code>.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="rand">
<span class="sig-name descname"><span class="pre">rand</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">double</span></span></span><a class="headerlink" href="#rand" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a random value with uniformly distributed values in [0, 1).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">rand</span><span class="p">();</span> <span class="o">--</span> <span class="mf">0.9629742951434543</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="id5">
<span class="sig-name descname"><span class="pre">rand</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partitionIndex</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">double</span></span></span><a class="headerlink" href="#id5" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a random value with uniformly distributed values in [0, 1) using a seed formed
by combining user-specified <code class="docutils literal notranslate"><span class="pre">seed</span></code> and framework provided <code class="docutils literal notranslate"><span class="pre">partitionIndex</span></code>. The
framework is responsible for deterministic partitioning of the data and assigning unique
<code class="docutils literal notranslate"><span class="pre">partitionIndex</span></code> to each thread (in a deterministic way).
<code class="docutils literal notranslate"><span class="pre">seed</span></code> must be constant. NULL <code class="docutils literal notranslate"><span class="pre">seed</span></code> is identical to zero <code class="docutils literal notranslate"><span class="pre">seed</span></code>. <code class="docutils literal notranslate"><span class="pre">partitionIndex</span></code>
cannot be NULL.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>    <span class="o">--</span> <span class="mf">0.5488135024422883</span>
<span class="n">SELECT</span> <span class="n">rand</span><span class="p">(</span><span class="n">NULL</span><span class="p">);</span> <span class="o">--</span> <span class="mf">0.5488135024422883</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="random">
<span class="sig-name descname"><span class="pre">random</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">double</span></span></span><a class="headerlink" href="#random" title="Permalink to this definition">¶</a></dt>
<dd><p>An alias for <code class="docutils literal notranslate"><span class="pre">rand()</span></code>.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="id6">
<span class="sig-name descname"><span class="pre">random</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partitionIndex</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">double</span></span></span><a class="headerlink" href="#id6" title="Permalink to this definition">¶</a></dt>
<dd><p>An alias for <code class="docutils literal notranslate"><span class="pre">rand(seed,</span> <span class="pre">partitionIndex)</span></code>.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="remainder">
<span class="sig-name descname"><span class="pre">remainder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">[same</span> <span class="pre">as</span> <span class="pre">n]</span></span></span><a class="headerlink" href="#remainder" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the modulus (remainder) of <code class="docutils literal notranslate"><span class="pre">n</span></code> divided by <code class="docutils literal notranslate"><span class="pre">m</span></code>. Corresponds to Spark’s operator <code class="docutils literal notranslate"><span class="pre">%</span></code>.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="round">
<span class="sig-name descname"><span class="pre">round</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">[same</span> <span class="pre">as</span> <span class="pre">x]</span></span></span><a class="headerlink" href="#round" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">x</span></code> rounded to <code class="docutils literal notranslate"><span class="pre">d</span></code> decimal places using HALF_UP rounding mode.
In HALF_UP rounding, the digit 5 is rounded up.
Supported types for <code class="docutils literal notranslate"><span class="pre">x</span></code> are integral and floating point types.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="sec">
<span class="sig-name descname"><span class="pre">sec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">double</span></span></span><a class="headerlink" href="#sec" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the secant of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="sinh">
<span class="sig-name descname"><span class="pre">sinh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">double</span></span></span><a class="headerlink" href="#sinh" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns hyperbolic sine of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="subtract">
<span class="sig-name descname"><span class="pre">subtract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">[same</span> <span class="pre">as</span> <span class="pre">x]</span></span></span><a class="headerlink" href="#subtract" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the result of subtracting y from x. The types of x and y must be the same.
For integral types, overflow results in an error. Corresponds to Spark’s operator <code class="docutils literal notranslate"><span class="pre">-</span></code>.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="id7">
<span class="sig-name descname"><span class="pre">subtract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">decimal</span></span></span><a class="headerlink" href="#id7" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the result of subtracting <code class="docutils literal notranslate"><span class="pre">y</span></code> from <code class="docutils literal notranslate"><span class="pre">x</span></code>. Reuses the logic of add function for decimal type.
Corresponds to Spark’s operator <code class="docutils literal notranslate"><span class="pre">-</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">CAST</span><span class="p">(</span><span class="mf">1.1232100</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span> <span class="o">-</span> <span class="n">CAST</span><span class="p">(</span><span class="mi">1</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span> <span class="o">--</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="mf">0.123210</span>
<span class="n">SELECT</span> <span class="n">CAST</span><span class="p">(</span><span class="o">-</span><span class="mf">999999999999999999999999999.999</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">-</span> <span class="n">CAST</span><span class="p">(</span><span class="o">-</span><span class="mf">999999999999999999999999999.999</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">3</span><span class="p">));</span> <span class="o">--</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="mf">0.000</span>
<span class="n">SELECT</span> <span class="n">CAST</span><span class="p">(</span><span class="mf">99999999999999999999999999999999.99998</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span> <span class="o">-</span> <span class="n">CAST</span><span class="p">(</span><span class="o">-</span><span class="mf">0.00001</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">5</span><span class="p">));</span> <span class="o">--</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="mf">99999999999999999999999999999999.999990</span>
<span class="n">SELECT</span> <span class="n">CAST</span><span class="p">(</span><span class="o">-</span><span class="mf">99999999999999999999999999999999990.0</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">-</span> <span class="n">CAST</span><span class="p">(</span><span class="mf">0.00001</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">7</span><span class="p">));</span> <span class="o">--</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="n">NULL</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="unaryminus">
<span class="sig-name descname"><span class="pre">unaryminus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">[same</span> <span class="pre">as</span> <span class="pre">x]</span></span></span><a class="headerlink" href="#unaryminus" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the negative of <cite>x</cite>.  Corresponds to Spark’s operator <code class="docutils literal notranslate"><span class="pre">-</span></code>.</p>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="../../spark_functions.html"
                          title="previous chapter">Spark Functions</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="bitwise.html"
                          title="next chapter">Bitwise Functions</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/functions/spark/math.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="bitwise.html" title="Bitwise Functions"
             >next</a> |</li>
        <li class="right" >
          <a href="../../spark_functions.html" title="Spark Functions"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Velox  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../spark_functions.html" >Spark Functions</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Mathematical Functions</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright TBD.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.2.
    </div>
  </body>
</html>